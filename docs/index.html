<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GitOps —Å ArgoCD –∏ Helm</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 2rem;
      background-color: #f9f9f9;
      color: #333;
    }
    h1, h2, h3 {
      color: #2c3e50;
    }
    pre {
      background: #272822;
      color: #f8f8f2;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 5px;
    }
    code {
      background: #eee;
      padding: 0.2em 0.4em;
      border-radius: 3px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    a {
      color: #3498db;
    }
    .header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .emoji {
      font-size: 2rem;
    }
  </style>
</head>
<body>

<div class="header">
  <h1>üìò –ü—Ä–æ–µ–∫—Ç GitOps —Å ArgoCD –∏ Helm</h1>
  <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:</strong>
  –≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞–∫ –∫–æ–¥ (Infrastructure as Code) –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ Kubernetes —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º <strong>GitOps –ø–æ–¥—Ö–æ–¥–∞</strong> —á–µ—Ä–µ–∑ <strong>ArgoCD</strong> –∏ <strong>Helm —á–∞—Ä—Ç–æ–≤</strong>.</p>
</div>

<h2>üìå –û–±–∑–æ—Ä</h2>
<table>
  <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–ó–Ω–∞—á–µ–Ω–∏–µ</th></tr>
  <tr><td>–¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞</td><td>GitOps</td></tr>
  <tr><td>–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä</td><td>Kubernetes</td></tr>
  <tr><td>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç GitOps</td><td>ArgoCD</td></tr>
  <tr><td>–ú–µ—Ç–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞–º–∏</td><td>Helm</td></tr>
  <tr><td>–¶–µ–ª—å</td><td>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏–∑ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</td></tr>
</table>

<h2>üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h2>
<pre>

my-app/                # –ü—Ä–∏–º–µ—Ä Helm-—á–∞—Ä—Ç–∞
  ‚îú‚îÄ‚îÄ Chart.yaml         # –û–ø–∏—Å–∞–Ω–∏–µ —á–∞—Ä—Ç–∞
  ‚îú‚îÄ‚îÄ values.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  ‚îî‚îÄ‚îÄ templates/         # –®–∞–±–ª–æ–Ω—ã Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤
      ‚îú‚îÄ‚îÄ deployment.yaml
      ‚îî‚îÄ‚îÄ service.yaml
</pre>

<h2>üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>

<h3>1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Minikube (–ª–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä)</h3>
<pre>
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
minikube start --driver=docker
</pre>

<h3>2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ArgoCD</h3>
<pre>
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/v2.8.4/manifests/install.yaml
kubectl port-forward svc/argocd-server -n argocd 8080:https
</pre>

<h3>3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ ArgoCD</h3>
<pre>
argocd login localhost:8080 --insecure
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏–Ω "admin" –∏ –ø–∞—Ä–æ–ª—å –∏–∑:
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
</pre>

<h3>4. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ ArgoCD (—á–µ—Ä–µ–∑ CLI)</h3>
<pre>
argocd app create my-app \
  --repo https://github.com/<–≤–∞—à-–ª–æ–≥–∏–Ω>/gitops-demo-repo.git  \
  --path charts/my-app \
  --dest-server https://kubernetes.default.svc  \
  --dest-namespace default \
  --helm-chart my-app \
  --auto-prune \
  --sync-policy automated
</pre>

<h3>5. –ß–µ—Ä–µ–∑ UI ArgoCD</h3>
<ol>
  <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: <a href="https://localhost:8080">https://localhost:8080</a></li>
  <li>–ù–∞–∂–º–∏—Ç–µ <strong>+ New App</strong></li>
  <li>–£–∫–∞–∂–∏—Ç–µ:
    <ul>
      <li>Repository URL ‚Äî <code>https://github.com/<–≤–∞—à-–ª–æ–≥–∏–Ω>/gitops-demo-repo.git</code></li>
      <li>Path ‚Äî <code>charts/my-app</code></li>
      <li>Cluster URL ‚Äî <code>https://kubernetes.default.svc</code></li>
      <li>Namespace ‚Äî <code>default</code></li>
      <li>Sync Policy ‚Äî ‚úÖ Automated</li>
    </ul>
  </li>
  <li>–ù–∞–∂–º–∏—Ç–µ <strong>Create ‚Üí Sync</strong></li>
</ol>

<h2>üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</h2>
<p>–õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:</p>
<pre>
git add .
git commit -m "Update config"
git push origin main
</pre>
<p>ArgoCD –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.</p>

<h2>üõ°Ô∏è Self-healing</h2>
<p>–ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–æ –≤—Ä—É—á–Ω—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä:</p>
<pre>kubectl scale deployment my-app --replicas=5</pre>
<p>ArgoCD –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏—é –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.</p>

<h2>üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
<ul>
  <li>–°–º–µ–Ω–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
    <pre>argocd account update-password</pre>
  </li>
  <li>–î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSH-–∫–ª—é—á:
    <pre>ssh-keygen -t rsa -b 4096 -C "your_email@example.com"</pre>
    –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (<code>~/.ssh/id_rsa.pub</code>) –≤ ArgoCD ‚Üí Settings ‚Üí Repositories
  </li>
</ul>

<h2>üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</h2>
<h3>–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</h3>
<pre>
argocd app list
argocd app get my-app
argocd app sync my-app
argocd app history my-app
kubectl logs -n argocd <pod-name>
</pre>

<h3>–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:</h3>
<table>
  <tr><th>–û—à–∏–±–∫–∞</th><th>–ü—Ä–∏—á–∏–Ω–∞</th><th>–†–µ—à–µ–Ω–∏–µ</th></tr>
  <tr><td><code>repository not accessible</code></td><td>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é</td><td>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –∏ —Ç–∏–ø —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</td></tr>
  <tr><td><code>comparison error</code></td><td>–ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–æ–º –∏ Git</td><td>–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã</td></tr>
  <tr><td><code>invalid chart path</code></td><td>–ù–µ–≤–µ—Ä–Ω—ã–π –ø—É—Ç—å –¥–æ Helm —á–∞—Ä—Ç–∞</td><td>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ –∏ –µ—Å—Ç—å <code>Chart.yaml</code></td></tr>
</table>

<h2>‚úÖ –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ</h2>
<ul>
  <li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è</strong>: –ª—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.</li>
  <li><strong>Self-healing</strong>: –∫–ª–∞—Å—Ç–µ—Ä –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º –≤ Git.</li>
  <li><strong>–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</strong>: –ª–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏.</li>
  <li><strong>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è</strong>: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å—Ä–µ–¥—ã (dev/staging/prod).</li>
</ul>

<h2> üôå –ê–≤—Ç–æ—Ä </h2>

<p>ü™™ dmplastun</p>
<p>üìß dmitrij.plastun@gmail.com</p>
<p>üîó<a href="https://dmplastun.github.io/gitops-demo-repo/">–ü—Ä–æ–µ–∫—Ç GitOps —Å ArgoCD –∏ Helm</a></p> 

</body>
</html>
